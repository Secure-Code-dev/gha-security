<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub Actions Security Policies - Detailed Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #24292f;
            background-color: #ffffff;
        }

        .container {
            max-width: 1012px;
            margin: 0 auto;
            padding: 0 16px;
        }

        /* Header */
        .header {
            background-color: #24292f;
            color: white;
            padding: 1rem 0;
            border-bottom: 1px solid #30363d;
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .header h1 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .github-link {
            color: #58a6ff;
            text-decoration: none;
            font-weight: 500;
        }

        .github-link:hover {
            text-decoration: underline;
        }

        /* Main Content */
        .main-content {
            padding: 2rem 0;
        }

        .breadcrumb {
            margin-bottom: 1rem;
            font-size: 0.875rem;
            color: #656d76;
        }

        .breadcrumb a {
            color: #0969da;
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .page-title {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #24292f;
            text-align: center;
        }

        .page-description {
            font-size: 1.1rem;
            color: #656d76;
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        /* Security Policy Item */
        .policy-item {
            background-color: #f6f8fa;
            border: 1px solid #d0d7de;
            border-radius: 8px;
            margin-bottom: 2rem;
            overflow: hidden;
        }

        .policy-header {
            background-color: #24292f;
            color: white;
            padding: 1rem 1.5rem;
            font-size: 1.25rem;
            font-weight: 600;
        }

        .policy-content {
            padding: 1.5rem;
        }

        .policy-section {
            margin-bottom: 1.5rem;
        }

        .policy-section:last-child {
            margin-bottom: 0;
        }

        .policy-section h4 {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: #24292f;
        }

        .emoji {
            font-size: 1.1rem;
        }

        .problem { color: #cf222e; }
        .vulnerability { color: #9a6700; }
        .insecure { color: #cf222e; }
        .secure { color: #1a7f37; }
        .remediation { color: #0969da; }

        .policy-section p {
            margin-bottom: 0.75rem;
            color: #24292f;
        }

        .policy-section ul {
            margin-bottom: 0.75rem;
            padding-left: 1.5rem;
        }

        .policy-section li {
            margin-bottom: 0.25rem;
        }

        /* Code blocks */
        .code-block {
            background-color: #24292f;
            color: #e6edf3;
            border-radius: 6px;
            padding: 1rem;
            margin: 0.75rem 0;
            overflow-x: auto;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
            font-size: 0.875rem;
            line-height: 1.45;
        }

        .code-block pre {
            margin: 0;
        }

        .inline-code {
            background-color: rgba(175, 184, 193, 0.2);
            border-radius: 3px;
            padding: 0.2em 0.4em;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
            font-size: 0.85em;
        }

        /* Alert boxes */
        .alert {
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            border-radius: 6px;
            border-left: 4px solid;
        }

        .alert-note {
            background-color: #ddf4ff;
            border-left-color: #0969da;
            color: #0969da;
        }

        .alert-important {
            background-color: #fff8c5;
            border-left-color: #d1a650;
            color: #7d4e00;
        }

        .alert strong {
            font-weight: 600;
        }

        /* Example blocks */
        .example-block {
            border: 1px solid #d0d7de;
            border-radius: 6px;
            margin: 0.75rem 0;
        }

        .example-header {
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            font-weight: 600;
            border-bottom: 1px solid #d0d7de;
        }

        .insecure-header {
            background-color: #ffebe9;
            color: #cf222e;
        }

        .secure-header {
            background-color: #dafbe1;
            color: #1a7f37;
        }

        .example-content {
            padding: 0;
        }

        .example-content .code-block {
            margin: 0;
            border-radius: 0 0 6px 6px;
        }

        /* Footer */
        .footer {
            margin-top: 3rem;
            padding: 2rem 0;
            border-top: 1px solid #d0d7de;
            color: #656d76;
            text-align: center;
        }

        .footer a {
            color: #0969da;
            text-decoration: none;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 0 1rem;
            }
            
            .page-title {
                font-size: 1.5rem;
            }
            
            .header-content {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }

            .policy-content {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <h1>GitHub Action - Securing Workflow</h1>
            </div>
        </div>
    </header>

    <main class="main-content">
        <div class="container">
            <nav class="breadcrumb">
                <a href="https://github.com/secure-code-dev/gha-security">secure-code-dev/gha-security</a> / Policy-Guide.md
            </nav>

            <h1 class="page-title">GitHub Actions Security Best Practices</h1>
            <p class="page-description">
                This guide explains common GitHub Actions security policies with comprehensive details, insecure usage examples, and step-by-step remediation instructions. It also describes the vulnerabilities each bad practice can expose, to help you better understand the risk landscape.
            </p>

            <!-- GHA-SEC001 -->
            <div class="policy-item">
                <div class="policy-header">GHA-SEC001: Plaintext Secrets</div>
                <div class="policy-content">
                    <div class="policy-section">
                        <h4 class="problem"><span class="emoji">‚ùó</span> Problem</h4>
                        <p>Secrets should not be printed to logs or echoed in a way that exposes them. Logs are often accessible to users and secrets could be compromised.</p>
                    </div>
                    
                    <div class="policy-section">
                        <h4 class="vulnerability"><span class="emoji">üîç</span> Vulnerability</h4>
                        <p><strong>Exposure of credentials</strong> ‚Äî If a secret is printed to the console output, it can be harvested by insiders, attackers monitoring logs, or even by external contributors in public repositories. Secrets like API keys, tokens, or database passwords can then be used to gain unauthorized access.</p>
                    </div>

                    <div class="policy-section">
                        <h4 class="insecure"><span class="emoji">üö´</span> Insecure Example</h4>
                        <div class="example-block">
                            <div class="example-header insecure-header">‚ùå Insecure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>- run: echo "${{ secrets.MY_SECRET }}"</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="secure"><span class="emoji">‚úÖ</span> Secure Example</h4>
                        <div class="example-block">
                            <div class="example-header secure-header">‚úÖ Secure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>- run: some_command --token "${{ secrets.MY_SECRET }}"</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="remediation"><span class="emoji">üõ†Ô∏è</span> Remediation</h4>
                        <ul>
                            <li>Never log secrets directly.</li>
                            <li>Use secrets only in commands where they are essential.</li>
                            <li>Ensure the command or tool used does not print the secret accidentally.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- GHA-SEC002 -->
            <div class="policy-item">
                <div class="policy-header">GHA-SEC002: Untrusted Input in Shell Commands</div>
                <div class="policy-content">
                    <div class="policy-section">
                        <h4 class="problem"><span class="emoji">‚ùó</span> Problem</h4>
                        <p>GitHub events such as pull request titles, issue bodies, etc., can be manipulated by attackers. Using them in shell commands without sanitization can lead to injection vulnerabilities.</p>
                    </div>
                    
                    <div class="policy-section">
                        <h4 class="vulnerability"><span class="emoji">üîç</span> Vulnerability</h4>
                        <p><strong>Shell Injection Attacks</strong> ‚Äî Attackers can inject malicious payloads (e.g., shell commands, scripts) via untrusted fields like PR titles. This can lead to arbitrary code execution within the GitHub runner environment.</p>
                    </div>

                    <div class="policy-section">
                        <h4 class="insecure"><span class="emoji">üö´</span> Insecure Example</h4>
                        <div class="example-block">
                            <div class="example-header insecure-header">‚ùå Insecure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>- run: echo "${{ github.event.pull_request.title }}"</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="secure"><span class="emoji">‚úÖ</span> Secure Example</h4>
                        <div class="example-block">
                            <div class="example-header secure-header">‚úÖ Secure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>- run: |
    title="${{ github.event.pull_request.title }}"
    echo "Received title"</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="remediation"><span class="emoji">üõ†Ô∏è</span> Remediation</h4>
                        <ul>
                            <li>Assign untrusted inputs to local variables.</li>
                            <li>Avoid using direct command interpolation.</li>
                            <li>Validate and sanitize inputs wherever possible.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- GHA-SEC003 -->
            <div class="policy-item">
                <div class="policy-header">GHA-SEC003: Minimally Scoped Credentials</div>
                <div class="policy-content">
                    <div class="policy-section">
                        <h4 class="problem"><span class="emoji">‚ùó</span> Problem</h4>
                        <p>By default, the <span class="inline-code">GITHUB_TOKEN</span> is granted all permissions. Overprivileged tokens increase the attack surface.</p>
                    </div>
                    
                    <div class="policy-section">
                        <h4 class="vulnerability"><span class="emoji">üîç</span> Vulnerability</h4>
                        <p><strong>Privilege Escalation and Unauthorized Actions</strong> ‚Äî If a token with broad access is compromised, attackers can push code, create releases, modify workflows, or access sensitive repository information.</p>
                    </div>

                    <div class="policy-section">
                        <h4 class="insecure"><span class="emoji">üö´</span> Insecure Example</h4>
                        <div class="example-block">
                            <div class="example-header insecure-header">‚ùå Insecure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre># No permissions block</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="secure"><span class="emoji">‚úÖ</span> Secure Example</h4>
                        <div class="example-block">
                            <div class="example-header secure-header">‚úÖ Secure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>permissions:
  contents: read
  issues: write</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="remediation"><span class="emoji">üõ†Ô∏è</span> Remediation</h4>
                        <ul>
                            <li>Explicitly define the minimum required permissions in each workflow.</li>
                            <li>Start with zero permissions and incrementally add only necessary ones.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- GHA-SEC004 -->
            <div class="policy-item">
                <div class="policy-header">GHA-SEC004: Unknown Actions</div>
                <div class="policy-content">
                    <div class="policy-section">
                        <h4 class="problem"><span class="emoji">‚ùó</span> Problem</h4>
                        <p>Third-party actions may be malicious or compromised. Using actions from unknown sources increases risk.</p>
                    </div>
                    
                    <div class="policy-section">
                        <h4 class="vulnerability"><span class="emoji">üîç</span> Vulnerability</h4>
                        <p><strong>Supply Chain Attacks</strong> ‚Äî Attackers can introduce backdoors or malicious scripts into open-source actions, leading to credential theft, unauthorized code execution, or data exfiltration.</p>
                    </div>

                    <div class="policy-section">
                        <h4 class="insecure"><span class="emoji">üö´</span> Insecure Example</h4>
                        <div class="example-block">
                            <div class="example-header insecure-header">‚ùå Insecure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>- uses: some-user/unknown-action@v1</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="secure"><span class="emoji">‚úÖ</span> Secure Example</h4>
                        <div class="example-block">
                            <div class="example-header secure-header">‚úÖ Secure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>- uses: actions/checkout@v4</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="remediation"><span class="emoji">üõ†Ô∏è</span> Remediation</h4>
                        <ul>
                            <li>Use actions from trusted sources (<span class="inline-code">actions</span>, <span class="inline-code">github</span>, internally audited ones).</li>
                            <li>Maintain an <span class="inline-code">allowlist</span> in the <span class="inline-code">policy.yaml</span> for safe third-party actions in your organization.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- GHA-SEC005 -->
            <div class="policy-item">
                <div class="policy-header">GHA-SEC005: Non-specific Version Tags</div>
                <div class="policy-content">
                    <div class="policy-section">
                        <h4 class="problem"><span class="emoji">‚ùó</span> Problem</h4>
                        <p>Using version tags like <span class="inline-code">@v1</span> or <span class="inline-code">@main</span> can lead to unexpected changes if the action is updated.</p>
                    </div>
                    
                    <div class="policy-section">
                        <h4 class="vulnerability"><span class="emoji">üîç</span> Vulnerability</h4>
                        <p><strong>Unexpected Behavior or Compromise</strong> ‚Äî If an action author updates the version tag with malicious changes, your workflows could automatically pull the malicious update without any notice.</p>
                    </div>

                    <div class="policy-section">
                        <h4 class="insecure"><span class="emoji">üö´</span> Insecure Example</h4>
                        <div class="example-block">
                            <div class="example-header insecure-header">‚ùå Insecure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>- uses: actions/setup-node@v1
# or
- uses: actions/setup-node@latest
# or
- uses: actions/setup-node@main</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="secure"><span class="emoji">‚úÖ</span> Secure Example</h4>
                        <div class="example-block">
                            <div class="example-header secure-header">‚úÖ Secure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>- uses: actions/setup-node@v1.4.2
# or
- uses: actions/setup-node@&lt;commit-SHA&gt;</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="remediation"><span class="emoji">üõ†Ô∏è</span> Remediation</h4>
                        <ul>
                            <li>Pin actions to specific semantic versions or commit SHAs.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- GHA-SEC006 -->
            <div class="policy-item">
                <div class="policy-header">GHA-SEC006: Self-hosted Runners</div>
                <div class="policy-content">
                    <div class="policy-section">
                        <h4 class="problem"><span class="emoji">‚ùó</span> Problem</h4>
                        <p>Self-hosted runners can be compromised if exposed to untrusted code, especially in public repositories.</p>
                    </div>
                    
                    <div class="policy-section">
                        <h4 class="vulnerability"><span class="emoji">üîç</span> Vulnerability</h4>
                        <p><strong>Runner Takeover and Persistence</strong> ‚Äî Attackers could run code that installs backdoors, modifies runners, or escalates to broader infrastructure compromise.</p>
                    </div>

                    <div class="policy-section">
                        <h4 class="insecure"><span class="emoji">üö´</span> Insecure Example</h4>
                        <div class="example-block">
                            <div class="example-header insecure-header">‚ùå Insecure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>runs-on: [self-hosted]</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="secure"><span class="emoji">‚úÖ</span> Secure Example</h4>
                        <div class="example-block">
                            <div class="example-header secure-header">‚úÖ Secure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>runs-on: ubuntu-latest</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="remediation"><span class="emoji">üõ†Ô∏è</span> Remediation</h4>
                        <ul>
                            <li>Use GitHub-hosted runners for public workflows.</li>
                            <li>Restrict self-hosted runner access to trusted repositories only.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- GHA-SEC007 -->
            <div class="policy-item">
                <div class="policy-header">GHA-SEC007: `pull_request_target` and External SHA</div>
                <div class="policy-content">
                    <div class="policy-section">
                        <h4 class="problem"><span class="emoji">‚ùó</span> Problem</h4>
                        <p>The <span class="inline-code">pull_request_target</span> event runs with write permissions on the base repo but can checkout attacker-controlled code.</p>
                    </div>
                    
                    <div class="policy-section">
                        <h4 class="vulnerability"><span class="emoji">üîç</span> Vulnerability</h4>
                        <p><strong>Repository Compromise</strong> ‚Äî An attacker could create a PR with malicious code, which, if checked out insecurely, could be executed with elevated permissions.</p>
                    </div>

                    <div class="policy-section">
                        <h4 class="insecure"><span class="emoji">üö´</span> Insecure Example</h4>
                        <div class="example-block">
                            <div class="example-header insecure-header">‚ùå Insecure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>on: pull_request_target
jobs:
  test:
    steps:
      - uses: actions/checkout@v3
        with:
          ref: ${{ github.event.pull_request.head.sha }}</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="secure"><span class="emoji">‚úÖ</span> Secure Example</h4>
                        <div class="example-block">
                            <div class="example-header secure-header">‚úÖ Secure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>on: pull_request</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="remediation"><span class="emoji">üõ†Ô∏è</span> Remediation</h4>
                        <ul>
                            <li>Use <span class="inline-code">pull_request</span> instead of <span class="inline-code">pull_request_target</span> for untrusted contributions.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- GHA-SEC008 -->
            <div class="policy-item">
                <div class="policy-header">GHA-SEC008: Artifact Uploads with Sensitive Files</div>
                <div class="policy-content">
                    <div class="policy-section">
                        <h4 class="problem"><span class="emoji">‚ùó</span> Problem</h4>
                        <p>Sensitive files like <span class="inline-code">.env</span>, <span class="inline-code">.pem</span>, or private keys should not be uploaded as artifacts.</p>
                    </div>
                    
                    <div class="policy-section">
                        <h4 class="vulnerability"><span class="emoji">üîç</span> Vulnerability</h4>
                        <p><strong>Secret Leakage via Artifacts</strong> ‚Äî Uploaded artifacts may be accessible to unauthorized users or automated systems, exposing critical secrets.</p>
                    </div>

                    <div class="policy-section">
                        <h4 class="insecure"><span class="emoji">üö´</span> Insecure Example</h4>
                        <div class="example-block">
                            <div class="example-header insecure-header">‚ùå Insecure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>- uses: actions/upload-artifact@v3
  with:
    path: .env</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="secure"><span class="emoji">‚úÖ</span> Secure Example</h4>
                        <div class="example-block">
                            <div class="example-header secure-header">‚úÖ Secure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>- uses: actions/upload-artifact@v3
  with:
    path: logs/output.txt</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="remediation"><span class="emoji">üõ†Ô∏è</span> Remediation</h4>
                        <ul>
                            <li>Audit uploaded artifacts regularly.</li>
                            <li>Exclude sensitive files from uploads.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- GHA-SEC009 -->
            <div class="policy-item">
                <div class="policy-header">GHA-SEC009: Missing Checksum for Downloads</div>
                <div class="policy-content">
                    <div class="policy-section">
                        <h4 class="problem"><span class="emoji">‚ùó</span> Problem</h4>
                        <p>Downloaded scripts or binaries should be validated to ensure integrity.</p>
                    </div>
                    
                    <div class="policy-section">
                        <h4 class="vulnerability"><span class="emoji">üîç</span> Vulnerability</h4>
                        <p><strong>Remote Code Execution</strong> ‚Äî If an attacker modifies a downloaded script, and the checksum is not verified, arbitrary malicious code could be executed in your CI environment.</p>
                    </div>

                    <div class="policy-section">
                        <h4 class="insecure"><span class="emoji">üö´</span> Insecure Example</h4>
                        <div class="example-block">
                            <div class="example-header insecure-header">‚ùå Insecure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>- run: curl -sSL http://example.com/script.sh | bash</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="secure"><span class="emoji">‚úÖ</span> Secure Example</h4>
                        <div class="example-block">
                            <div class="example-header secure-header">‚úÖ Secure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>- run: |
    curl -sSL -o script.sh http://example.com/script.sh
    echo "abcd1234  script.sh" | sha256sum -c -
    bash script.sh</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="remediation"><span class="emoji">üõ†Ô∏è</span> Remediation</h4>
                        <ul>
                            <li>Validate all downloads before execution using SHA256 or GPG signatures.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- GHA-SEC010 -->
            <div class="policy-item">
                <div class="policy-header">GHA-SEC010: Secrets in Global `env:`</div>
                <div class="policy-content">
                    <div class="policy-section">
                        <h4 class="problem"><span class="emoji">‚ùó</span> Problem</h4>
                        <p>Secrets should be scoped to steps. Using them globally increases exposure.</p>
                    </div>
                    
                    <div class="policy-section">
                        <h4 class="vulnerability"><span class="emoji">üîç</span> Vulnerability</h4>
                        <p><strong>Increased Secret Exposure</strong> ‚Äî Secrets available globally can be accidentally leaked if printed or used in any other untrusted step.</p>
                    </div>

                    <div class="policy-section">
                        <h4 class="insecure"><span class="emoji">üö´</span> Insecure Example</h4>
                        <div class="example-block">
                            <div class="example-header insecure-header">‚ùå Insecure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>env:
  SECRET_TOKEN: ${{ secrets.MY_SECRET }}</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="secure"><span class="emoji">‚úÖ</span> Secure Example</h4>
                        <div class="example-block">
                            <div class="example-header secure-header">‚úÖ Secure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>- run: ./script.sh
  env:
    SECRET_TOKEN: ${{ secrets.MY_SECRET }}</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="remediation"><span class="emoji">üõ†Ô∏è</span> Remediation</h4>
                        <ul>
                            <li>Always scope secrets at the minimal necessary level (preferably individual steps).</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- GHA-SEC011 -->
            <div class="policy-item">
                <div class="policy-header">GHA-SEC011: Auto-Approve Pull Requests</div>
                <div class="policy-content">
                    <div class="policy-section">
                        <h4 class="problem"><span class="emoji">‚ùó</span> Problem</h4>
                        <p>Automating approval can allow malicious changes to be merged without human oversight.</p>
                    </div>
                    
                    <div class="policy-section">
                        <h4 class="vulnerability"><span class="emoji">üîç</span> Vulnerability</h4>
                        <p><strong>Unauthorized Code Merge</strong> ‚Äî Malicious PRs could be auto-approved and merged, leading to supply chain attacks, credential leaks, or infrastructure damage.</p>
                    </div>

                    <div class="policy-section">
                        <h4 class="insecure"><span class="emoji">üö´</span> Insecure Example</h4>
                        <div class="example-block">
                            <div class="example-header insecure-header">‚ùå Insecure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>- run: gh pr review --approve</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="secure"><span class="emoji">‚úÖ</span> Secure Example</h4>
                        <div class="example-block">
                            <div class="example-header secure-header">‚úÖ Secure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre># Use manual review from maintainers</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="remediation"><span class="emoji">üõ†Ô∏è</span> Remediation</h4>
                        <ul>
                            <li>Always require human review, even if PRs come from trusted contributors.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- GHA-SEC012 -->
            <div class="policy-item">
                <div class="policy-header">GHA-SEC012: `continue-on-error: true`</div>
                <div class="policy-content">
                    <div class="policy-section">
                        <h4 class="problem"><span class="emoji">‚ùó</span> Problem</h4>
                        <p>Using <span class="inline-code">continue-on-error: true</span> hides failures, leading to false positives.</p>
                    </div>
                    
                    <div class="policy-section">
                        <h4 class="vulnerability"><span class="emoji">üîç</span> Vulnerability</h4>
                        <p><strong>Silent Failures and Insecure Builds</strong> ‚Äî Failures in critical security checks, test cases, or build steps might be ignored, resulting in insecure or broken deployments.</p>
                    </div>

                    <div class="policy-section">
                        <h4 class="insecure"><span class="emoji">üö´</span> Insecure Example</h4>
                        <div class="example-block">
                            <div class="example-header insecure-header">‚ùå Insecure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>- run: make test
  continue-on-error: true</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="secure"><span class="emoji">‚úÖ</span> Secure Example</h4>
                        <div class="example-block">
                            <div class="example-header secure-header">‚úÖ Secure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>- run: make test
  continue-on-error: false</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="remediation"><span class="emoji">üõ†Ô∏è</span> Remediation</h4>
                        <ul>
                            <li>Use <span class="inline-code">continue-on-error</span> cautiously, only when failure is acceptable.</li>
                            <li>Prefer explicit conditional logic (<span class="inline-code">if: failure()</span>).</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- GHA-SEC013 -->
            <div class="policy-item">
                <div class="policy-header">GHA-SEC013: Deprecated `set-output` Command</div>
                <div class="policy-content">
                    <div class="policy-section">
                        <h4 class="problem"><span class="emoji">‚ùó</span> Problem</h4>
                        <p>The <span class="inline-code">::set-output</span> command is deprecated and less secure.</p>
                    </div>
                    
                    <div class="policy-section">
                        <h4 class="vulnerability"><span class="emoji">üîç</span> Vulnerability</h4>
                        <p><strong>Output Injection</strong> ‚Äî Deprecated commands like <span class="inline-code">::set-output</span> can be vulnerable to unexpected input parsing issues and injection attacks.</p>
                    </div>

                    <div class="policy-section">
                        <h4 class="insecure"><span class="emoji">üö´</span> Insecure Example</h4>
                        <div class="example-block">
                            <div class="example-header insecure-header">‚ùå Insecure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>- run: echo "::set-output name=version::1.0"</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="secure"><span class="emoji">‚úÖ</span> Secure Example</h4>
                        <div class="example-block">
                            <div class="example-header secure-header">‚úÖ Secure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>- run: echo "version=1.0" >> "$GITHUB_OUTPUT"</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="remediation"><span class="emoji">üõ†Ô∏è</span> Remediation</h4>
                        <ul>
                            <li>Migrate to the modern <span class="inline-code">$GITHUB_OUTPUT</span> method for all workflows.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- GHA-SEC014 -->
            <div class="policy-item">
                <div class="policy-header">GHA-SEC014: Use of Legacy GCP Authentication</div>
                <div class="policy-content">
                    <div class="policy-section">
                        <h4 class="problem"><span class="emoji">‚ùó</span> Problem</h4>
                        <p>Using <span class="inline-code">credentials_json</span> for authentication with Google Cloud is a legacy method that involves managing long-lived secrets, which is less secure.</p>
                    </div>
                    
                    <div class="policy-section">
                        <h4 class="vulnerability"><span class="emoji">üîç</span> Vulnerability</h4>
                        <p><strong>Secret Leakage Risk</strong> ‚Äî Embedding static service account keys like <span class="inline-code">credentials_json</span> increases the risk of accidental leakage, misuse, or unauthorized access if the key is exposed in the CI/CD pipeline or version control.</p>
                    </div>

                    <div class="policy-section">
                        <h4 class="insecure"><span class="emoji">üö´</span> Insecure Example</h4>
                        <div class="example-block">
                            <div class="example-header insecure-header">‚ùå Insecure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>- name: Authenticate with GCP
  id: 'auth'
  uses: 'google-github-actions/auth@v2'
  with:
    credentials_json: '&lt;YOUR-SERVICE-ACCOUNT-FILE-AS-INPUT&gt;'</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="secure"><span class="emoji">‚úÖ</span> Secure Example</h4>
                        <div class="example-block">
                            <div class="example-header secure-header">‚úÖ Secure</div>
                            <div class="example-content">
                                <div class="code-block">
                                    <pre>- name: Authenticate to GCP
  uses: google-github-actions/auth@v2
  with:
    token_format: 'access_token'
    workload_identity_provider: '&lt;YOUR-WORKFLOW-IDENTITY-PROVIDER&gt;'
    service_account: '&lt;SERVICE-ACCOUNT&gt;'</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="policy-section">
                        <h4 class="remediation"><span class="emoji">üõ†Ô∏è</span> Remediation</h4>
                        <ul>
                            <li>Stop using <span class="inline-code">credentials_json</span> for authentication.</li>
                            <li>Set up a <a href="https://cloud.google.com/iam/docs/workload-identity-federation">Workload Identity Federation provider</a> in your GCP project.</li>
                            <li>This enables short-lived, automatically rotated tokens without needing long-lived secrets.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Additional Notes -->
            <div class="alert alert-note">
                <strong>üìå Additional Note:</strong><br>
                Each policy rule in <span class="inline-code">policy.yaml</span> supports an <span class="inline-code">exclude</span> parameter. If you want to intentionally allow a specific workflow or action to violate a policy (for example, due to justified exceptions), you can list the workflow or action path under the <span class="inline-code">exclude</span> field.
            </div>

            <div class="policy-item">
                <div class="policy-header">Example Policy Configuration</div>
                <div class="policy-content">
                    <div class="code-block">
                        <pre>policies:
  minimally-scoped-credentials:
      code: GHA-SEC003
      level: warning
      description: "Workflow is missing 'permissions' block"
      missing_block: permissions
      exclude:
        - .github/workflows/new-changes.yaml</pre>
                    </div>
                    <p>In the above example, the <span class="inline-code">new-changes.yaml</span> workflow will be excluded from the "Minimally Scoped Credentials" (GHA-SEC003) policy check during scanning.</p>
                </div>
            </div>

            <div class="alert alert-important">
                <strong>üìå Important:</strong> Regularly audit workflows for these patterns. Keep up-to-date with GitHub Actions <a href="https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions">Security Best Practices</a>.
